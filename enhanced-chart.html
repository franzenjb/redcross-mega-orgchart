<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>American Red Cross - SE & Caribbean Division Deep Organizational Chart</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background: #f5f5f5;
            overflow: auto;
        }
        
        #header {
            background: white;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border-bottom: 3px solid #ED1B2E;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
        }
        
        #header h1 {
            margin: 0;
            color: #ED1B2E;
            font-size: 24px;
        }
        
        #header p {
            margin: 5px 0 0 0;
            color: #666;
            font-size: 14px;
        }
        
        #controls {
            background: white;
            padding: 15px 20px;
            border-bottom: 1px solid #ddd;
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
            position: fixed;
            top: 73px;
            left: 0;
            right: 0;
            z-index: 999;
        }
        
        #controls button {
            padding: 8px 16px;
            background: #ED1B2E;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
        }
        
        #controls button:hover {
            background: #c41e3a;
            transform: translateY(-1px);
        }
        
        #controls button.active {
            background: #8B0000;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.2);
        }
        
        #controls input {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            width: 250px;
        }
        
        #controls select {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            min-width: 180px;
        }
        
        .control-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .control-label {
            font-size: 13px;
            color: #666;
            font-weight: 500;
        }
        
        #chart-container {
            margin-top: 140px;
            padding: 40px;
            overflow: auto;
            min-height: calc(100vh - 140px);
            transition: all 0.3s ease;
        }
        
        #legend {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
            z-index: 1000;
            font-size: 13px;
            max-height: 400px;
            overflow-y: auto;
        }
        
        #legend h3 {
            margin: 0 0 10px 0;
            font-size: 14px;
            color: #333;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            margin: 5px 0;
            cursor: pointer;
            padding: 3px;
            border-radius: 3px;
            transition: background 0.2s;
        }
        
        .legend-item:hover {
            background: #f0f0f0;
        }
        
        .legend-color {
            width: 20px;
            height: 20px;
            margin-right: 8px;
            border-radius: 3px;
            border: 1px solid #ddd;
        }
        
        /* Search results panel */
        #search-results {
            position: fixed;
            top: 140px;
            left: 20px;
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
            z-index: 900;
            max-height: 300px;
            overflow-y: auto;
            display: none;
            min-width: 250px;
        }
        
        #search-results h4 {
            margin: 0 0 10px 0;
            font-size: 14px;
            color: #333;
        }
        
        .search-result-item {
            padding: 8px;
            margin: 5px 0;
            border-radius: 4px;
            cursor: pointer;
            background: #f5f5f5;
            transition: all 0.2s;
            font-size: 13px;
        }
        
        .search-result-item:hover {
            background: #e0e0e0;
            transform: translateX(3px);
        }
        
        .search-result-name {
            font-weight: 600;
            color: #333;
        }
        
        .search-result-title {
            color: #666;
            font-size: 12px;
        }
        
        .search-result-location {
            color: #999;
            font-size: 11px;
            font-style: italic;
        }
        
        /* Chart styles */
        .org-chart {
            display: inline-block;
            min-width: 100%;
            padding: 20px;
            transition: transform 0.3s ease;
        }
        
        .org-chart.zoomed {
            transform-origin: center;
        }
        
        /* Tree structure */
        .tree {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .tree ul {
            padding-left: 40px;
            position: relative;
            margin-top: 10px;
            transition: all 0.3s ease;
        }
        
        .tree li {
            list-style: none;
            margin: 10px 0;
            position: relative;
            padding-left: 35px;
        }
        
        .tree li::before {
            content: '';
            position: absolute;
            top: 20px;
            left: -15px;
            width: 35px;
            height: 1px;
            background: #ccc;
        }
        
        .tree li::after {
            content: '';
            position: absolute;
            left: -15px;
            top: 0;
            bottom: 0;
            width: 1px;
            background: #ccc;
        }
        
        .tree li:last-child::after {
            height: 20px;
        }
        
        .tree > li::before,
        .tree > li::after {
            display: none;
        }
        
        /* Node styles */
        .node {
            display: inline-block;
            padding: 10px 15px;
            border-radius: 8px;
            color: white;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
            min-width: 180px;
            max-width: 250px;
            position: relative;
            text-align: left;
        }
        
        .node:hover {
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-title {
            font-weight: 600;
            font-size: 11px;
            margin-bottom: 3px;
            opacity: 0.9;
        }
        
        .node-name {
            font-size: 14px;
            margin-bottom: 2px;
            font-weight: 500;
        }
        
        .node-location {
            font-size: 11px;
            opacity: 0.8;
            font-style: italic;
        }
        
        .node-count {
            position: absolute;
            top: 5px;
            right: 5px;
            background: rgba(255,255,255,0.3);
            padding: 2px 6px;
            border-radius: 10px;
            font-size: 10px;
            font-weight: 600;
        }
        
        .toggle-btn {
            position: absolute;
            bottom: 5px;
            right: 5px;
            width: 18px;
            height: 18px;
            background: rgba(255,255,255,0.3);
            border: 1px solid rgba(255,255,255,0.5);
            border-radius: 50%;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
            font-weight: bold;
            transition: all 0.2s;
        }
        
        .toggle-btn:hover {
            background: rgba(255,255,255,0.5);
            transform: scale(1.2);
        }
        
        .collapsed > ul {
            display: none;
        }
        
        /* Division section styling */
        .division-section {
            background: rgba(237, 27, 46, 0.03);
            border: 2px dashed #ED1B2E;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .division-header {
            text-align: center;
            color: #ED1B2E;
            font-weight: 600;
            margin-bottom: 20px;
            font-size: 16px;
            text-transform: uppercase;
        }
        
        .division-roles {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 30px;
        }
        
        /* Regional sections */
        .regional-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        
        .regional-section {
            background: white;
            border: 1px solid #ddd;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        
        .regional-header {
            font-weight: 600;
            font-size: 18px;
            padding: 10px;
            border-radius: 6px;
            text-align: center;
            margin-bottom: 15px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .regional-header:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        /* Color classes */
        .division { background: #ED1B2E; }
        .divisional-role { background: #8B0000; }
        .georgia { background: #2E86AB; }
        .alabama { background: #A23B72; }
        .northcarolina { background: #F18F01; }
        .southcarolina { background: #C73E1D; }
        .tennessee { background: #6B4423; }
        .ncflorida { background: #00A86B; }
        .sflorida { background: #FF6B9D; }
        .puertorico { background: #4169E1; }
        .vacant { background: #666666; }
        
        .georgia-header { background: rgba(46, 134, 171, 0.1); color: #2E86AB; border: 2px solid #2E86AB; }
        .alabama-header { background: rgba(162, 59, 114, 0.1); color: #A23B72; border: 2px solid #A23B72; }
        .northcarolina-header { background: rgba(241, 143, 1, 0.1); color: #F18F01; border: 2px solid #F18F01; }
        .southcarolina-header { background: rgba(199, 62, 29, 0.1); color: #C73E1D; border: 2px solid #C73E1D; }
        .tennessee-header { background: rgba(107, 68, 35, 0.1); color: #6B4423; border: 2px solid #6B4423; }
        .ncflorida-header { background: rgba(0, 168, 107, 0.1); color: #00A86B; border: 2px solid #00A86B; }
        .sflorida-header { background: rgba(255, 107, 157, 0.1); color: #FF6B9D; border: 2px solid #FF6B9D; }
        
        /* Highlight animation */
        .highlight {
            animation: pulse 1.5s ease-in-out infinite;
        }
        
        @keyframes pulse {
            0%, 100% { 
                box-shadow: 0 2px 4px rgba(0,0,0,0.2), 0 0 0 3px rgba(237, 27, 46, 0.6);
                transform: scale(1.05);
            }
            50% { 
                box-shadow: 0 2px 4px rgba(0,0,0,0.2), 0 0 0 6px rgba(237, 27, 46, 0.3);
                transform: scale(1.08);
            }
        }
        
        /* Focus mode styling */
        .focus-mode {
            position: fixed;
            top: 140px;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 800;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 40px;
            overflow: auto;
        }
        
        .focus-content {
            background: white;
            border-radius: 12px;
            padding: 30px;
            max-width: 90%;
            max-height: 90%;
            overflow: auto;
            position: relative;
        }
        
        .focus-close {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 30px;
            height: 30px;
            background: #ED1B2E;
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            font-size: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .focus-close:hover {
            background: #c41e3a;
        }
        
        /* Stats display */
        #stats {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
            font-size: 13px;
            z-index: 900;
        }
        
        #stats h4 {
            margin: 0 0 5px 0;
            font-size: 14px;
            color: #333;
        }
        
        .stat-item {
            display: flex;
            justify-content: space-between;
            margin: 3px 0;
        }
        
        .stat-label {
            color: #666;
        }
        
        .stat-value {
            font-weight: 600;
            color: #ED1B2E;
        }
        
        /* Horizontal layout mode */
        .horizontal-layout .tree ul {
            display: flex;
            padding-left: 0;
            padding-top: 40px;
        }
        
        .horizontal-layout .tree li {
            padding-left: 0;
            padding-top: 35px;
            margin: 0 10px;
        }
        
        .horizontal-layout .tree li::before {
            top: -15px;
            left: 50%;
            width: 1px;
            height: 35px;
            transform: translateX(-50%);
        }
        
        .horizontal-layout .tree li::after {
            display: none;
        }
    </style>
    <script src="deep-org-data.js"></script>
</head>
<body>
    <div id="header">
        <h1>American Red Cross - SE & Caribbean Division</h1>
        <p id="header-subtitle">Complete Deep Organizational Structure - <span id="node-count">0</span> Total Positions</p>
    </div>
    
    <div id="controls">
        <div class="control-group">
            <input type="text" id="searchBox" placeholder="Search by name, position, or location..." onkeyup="handleSearch(this.value)">
            <button onclick="clearSearch()">Clear</button>
        </div>
        
        <div class="control-group">
            <span class="control-label">View:</span>
            <select id="viewMode" onchange="changeViewMode(this.value)">
                <option value="overview">Division Overview</option>
                <option value="georgia">Georgia - Full Tree</option>
                <option value="alabama">Alabama/MS - Full Tree</option>
                <option value="northcarolina">North Carolina - Full Tree</option>
                <option value="southcarolina">South Carolina - Full Tree</option>
                <option value="tennessee">Tennessee - Full Tree</option>
                <option value="ncflorida">N/C Florida - Full Tree</option>
                <option value="sflorida">South Florida - Full Tree</option>
                <option value="all">All Regions Expanded</option>
            </select>
        </div>
        
        <div class="control-group">
            <button onclick="expandAll()">Expand All</button>
            <button onclick="collapseAll()">Collapse All</button>
            <button id="layoutToggle" onclick="toggleLayout()">Switch to Horizontal</button>
        </div>
        
        <div class="control-group">
            <span class="control-label">Depth:</span>
            <select id="depthControl" onchange="setDepth(this.value)">
                <option value="1">Level 1 - Executives</option>
                <option value="2">Level 2 - Directors</option>
                <option value="3">Level 3 - Managers</option>
                <option value="4">Level 4 - Specialists</option>
                <option value="all" selected>All Levels</option>
            </select>
        </div>
    </div>
    
    <div id="search-results">
        <h4>Search Results</h4>
        <div id="search-results-list"></div>
    </div>
    
    <div id="stats">
        <h4>Statistics</h4>
        <div class="stat-item">
            <span class="stat-label">Total Positions:</span>
            <span class="stat-value" id="totalPositions">0</span>
        </div>
        <div class="stat-item">
            <span class="stat-label">Expanded Nodes:</span>
            <span class="stat-value" id="expandedNodes">0</span>
        </div>
        <div class="stat-item">
            <span class="stat-label">Current View:</span>
            <span class="stat-value" id="currentView">Overview</span>
        </div>
    </div>
    
    <div id="legend">
        <h3>Organization Color Coding</h3>
        <div class="legend-item" onclick="filterByType('division')">
            <div class="legend-color" style="background: #ED1B2E;"></div>
            <span>Division VP</span>
        </div>
        <div class="legend-item" onclick="filterByType('divisional-role')">
            <div class="legend-color" style="background: #8B0000;"></div>
            <span>Division-Wide Roles</span>
        </div>
        <div class="legend-item" onclick="changeViewMode('georgia')">
            <div class="legend-color" style="background: #2E86AB;"></div>
            <span>Georgia Region</span>
        </div>
        <div class="legend-item" onclick="changeViewMode('alabama')">
            <div class="legend-color" style="background: #A23B72;"></div>
            <span>Alabama/Mississippi</span>
        </div>
        <div class="legend-item" onclick="changeViewMode('northcarolina')">
            <div class="legend-color" style="background: #F18F01;"></div>
            <span>North Carolina</span>
        </div>
        <div class="legend-item" onclick="changeViewMode('southcarolina')">
            <div class="legend-color" style="background: #C73E1D;"></div>
            <span>South Carolina</span>
        </div>
        <div class="legend-item" onclick="changeViewMode('tennessee')">
            <div class="legend-color" style="background: #6B4423;"></div>
            <span>Tennessee</span>
        </div>
        <div class="legend-item" onclick="changeViewMode('ncflorida')">
            <div class="legend-color" style="background: #00A86B;"></div>
            <span>N/C Florida</span>
        </div>
        <div class="legend-item" onclick="changeViewMode('sflorida')">
            <div class="legend-color" style="background: #FF6B9D;"></div>
            <span>South Florida</span>
        </div>
        <div class="legend-item" onclick="filterByType('vacant')">
            <div class="legend-color" style="background: #666;"></div>
            <span>Vacant Positions</span>
        </div>
    </div>
    
    <div id="chart-container">
        <div class="org-chart" id="orgChart"></div>
    </div>
    
    <div id="focus-mode" class="focus-mode">
        <div class="focus-content" id="focus-content">
            <button class="focus-close" onclick="closeFocusMode()">×</button>
            <div id="focus-tree"></div>
        </div>
    </div>
    
    <script>
        let currentLayout = 'vertical';
        let currentView = 'overview';
        let searchResults = [];
        let allNodes = [];
        
        // Build the complete organizational structure
        function buildCompleteOrgStructure() {
            return {
                name: "Anna Trefethen",
                title: "Division Vice President",
                location: "SE & Caribbean Division",
                type: "division",
                children: [
                    {
                        name: "Division Leadership",
                        title: "Division-Wide Roles",
                        type: "divisional-section",
                        children: [
                            { name: "Dee Dixon", title: "DFVP", type: "divisional-role" },
                            { name: "Vickey Barnett", title: "Dir. Division Fundraising", type: "divisional-role" },
                            { name: "Kay Gonzalez", title: "Div. SAF Director", type: "divisional-role" },
                            { name: "Leisle Mims", title: "DCOO", type: "divisional-role" },
                            { name: "Silvia Taylor", title: "DVSE", type: "divisional-role" },
                            { name: "Cally Edwards", title: "DCD", type: "divisional-role" },
                            { name: "Ryan Lock", title: "DDE", type: "divisional-role" }
                        ]
                    },
                    deepOrgData.georgia,
                    deepOrgData.alabama,
                    deepOrgData.northcarolina,
                    deepOrgData.southcarolina,
                    deepOrgData.tennessee,
                    deepOrgData.ncflorida,
                    deepOrgData.sflorida
                ]
            };
        }
        
        // Create a tree node element
        function createNodeElement(data, depth = 0) {
            const li = document.createElement('li');
            
            if (data.type === 'divisional-section') {
                // Special handling for division section
                const divSection = document.createElement('div');
                divSection.className = 'division-section';
                divSection.innerHTML = '<div class="division-header">Division-Wide Leadership (Serving All Regions)</div>';
                
                const rolesDiv = document.createElement('div');
                rolesDiv.className = 'division-roles';
                
                data.children.forEach(child => {
                    const node = document.createElement('div');
                    node.className = `node ${child.type || 'divisional-role'}`;
                    node.innerHTML = `
                        <div class="node-name">${child.name}</div>
                        <div class="node-title">${child.title}</div>
                        ${child.location ? `<div class="node-location">${child.location}</div>` : ''}
                    `;
                    node.onclick = () => handleNodeClick(child);
                    rolesDiv.appendChild(node);
                    allNodes.push({ element: node, data: child, depth });
                });
                
                divSection.appendChild(rolesDiv);
                li.appendChild(divSection);
            } else {
                // Regular node
                const node = document.createElement('div');
                node.className = `node ${data.type || 'vacant'}`;
                
                const childCount = data.children ? countAllChildren(data) : 0;
                
                node.innerHTML = `
                    <div class="node-name">${data.name}</div>
                    <div class="node-title">${data.title}</div>
                    ${data.location ? `<div class="node-location">${data.location}</div>` : ''}
                    ${childCount > 0 ? `<div class="node-count">${childCount}</div>` : ''}
                    ${data.children && data.children.length > 0 ? '<span class="toggle-btn" onclick="toggleNode(event, this)">+</span>' : ''}
                `;
                
                node.onclick = (e) => {
                    if (!e.target.classList.contains('toggle-btn')) {
                        handleNodeClick(data);
                    }
                };
                
                li.appendChild(node);
                allNodes.push({ element: node, data, depth });
                
                // Add children
                if (data.children && data.children.length > 0) {
                    const ul = document.createElement('ul');
                    ul.style.display = 'none'; // Start collapsed
                    
                    data.children.forEach(child => {
                        ul.appendChild(createNodeElement(child, depth + 1));
                    });
                    
                    li.appendChild(ul);
                    li.classList.add('collapsed');
                }
            }
            
            return li;
        }
        
        // Count all children recursively
        function countAllChildren(node) {
            let count = 0;
            if (node.children) {
                count += node.children.length;
                node.children.forEach(child => {
                    count += countAllChildren(child);
                });
            }
            return count;
        }
        
        // Toggle node expansion
        function toggleNode(event, btn) {
            event.stopPropagation();
            const li = btn.closest('li');
            const ul = li.querySelector('ul');
            
            if (ul) {
                if (ul.style.display === 'none') {
                    ul.style.display = 'block';
                    btn.textContent = '-';
                    li.classList.remove('collapsed');
                } else {
                    ul.style.display = 'none';
                    btn.textContent = '+';
                    li.classList.add('collapsed');
                }
            }
            updateStats();
        }
        
        // Handle node click
        function handleNodeClick(data) {
            console.log('Node clicked:', data);
            // Could open a detail panel or focus mode here
        }
        
        // Search functionality
        function handleSearch(query) {
            const resultsPanel = document.getElementById('search-results');
            const resultsList = document.getElementById('search-results-list');
            
            // Clear previous highlights
            document.querySelectorAll('.node').forEach(node => {
                node.classList.remove('highlight');
            });
            
            if (query.length < 2) {
                resultsPanel.style.display = 'none';
                return;
            }
            
            searchResults = [];
            resultsList.innerHTML = '';
            
            allNodes.forEach(({ element, data, depth }) => {
                const searchText = `${data.name} ${data.title || ''} ${data.location || ''}`.toLowerCase();
                if (searchText.includes(query.toLowerCase())) {
                    searchResults.push({ element, data, depth });
                    
                    // Create search result item
                    const resultItem = document.createElement('div');
                    resultItem.className = 'search-result-item';
                    resultItem.innerHTML = `
                        <div class="search-result-name">${data.name}</div>
                        ${data.title ? `<div class="search-result-title">${data.title}</div>` : ''}
                        ${data.location ? `<div class="search-result-location">${data.location}</div>` : ''}
                    `;
                    resultItem.onclick = () => zoomToNode(element, data);
                    resultsList.appendChild(resultItem);
                    
                    // Highlight the node
                    element.classList.add('highlight');
                }
            });
            
            if (searchResults.length > 0) {
                resultsPanel.style.display = 'block';
                document.getElementById('search-results').querySelector('h4').textContent = 
                    `Search Results (${searchResults.length})`;
            } else {
                resultsPanel.style.display = 'none';
            }
        }
        
        // Zoom to specific node
        function zoomToNode(element, data) {
            // Expand all parents
            let parent = element.closest('li');
            while (parent) {
                const ul = parent.querySelector('ul');
                if (ul) {
                    ul.style.display = 'block';
                    const btn = parent.querySelector('.toggle-btn');
                    if (btn) btn.textContent = '-';
                    parent.classList.remove('collapsed');
                }
                parent = parent.parentElement?.closest('li');
            }
            
            // Scroll to element
            element.scrollIntoView({ behavior: 'smooth', block: 'center' });
            
            // Flash highlight
            element.classList.add('highlight');
            setTimeout(() => {
                element.classList.remove('highlight');
            }, 3000);
            
            updateStats();
        }
        
        // Clear search
        function clearSearch() {
            document.getElementById('searchBox').value = '';
            document.getElementById('search-results').style.display = 'none';
            document.querySelectorAll('.node').forEach(node => {
                node.classList.remove('highlight');
            });
        }
        
        // Change view mode
        function changeViewMode(mode) {
            currentView = mode;
            document.getElementById('viewMode').value = mode;
            
            const container = document.getElementById('orgChart');
            container.innerHTML = '';
            
            const ul = document.createElement('ul');
            ul.className = 'tree';
            
            if (mode === 'overview') {
                // Show complete structure but collapsed
                const fullStructure = buildCompleteOrgStructure();
                ul.appendChild(createNodeElement(fullStructure));
            } else if (mode === 'all') {
                // Show everything expanded
                const fullStructure = buildCompleteOrgStructure();
                const li = createNodeElement(fullStructure);
                ul.appendChild(li);
                setTimeout(() => expandAll(), 100);
            } else {
                // Show specific region fully expanded
                const regionData = deepOrgData[mode];
                if (regionData) {
                    // Add division VP at top
                    const divisionNode = {
                        name: "Anna Trefethen",
                        title: "Division Vice President",
                        location: "SE & Caribbean Division",
                        type: "division",
                        children: [regionData]
                    };
                    const li = createNodeElement(divisionNode);
                    ul.appendChild(li);
                    setTimeout(() => expandAll(), 100);
                }
            }
            
            container.appendChild(ul);
            updateStats();
            document.getElementById('currentView').textContent = 
                mode.charAt(0).toUpperCase() + mode.slice(1).replace('ncflorida', 'N/C Florida').replace('sflorida', 'S Florida');
        }
        
        // Expand all nodes
        function expandAll() {
            const allUls = document.querySelectorAll('.tree ul');
            const allBtns = document.querySelectorAll('.toggle-btn');
            const allLis = document.querySelectorAll('.tree li');
            
            allUls.forEach(ul => ul.style.display = 'block');
            allBtns.forEach(btn => btn.textContent = '-');
            allLis.forEach(li => li.classList.remove('collapsed'));
            
            updateStats();
        }
        
        // Collapse all nodes
        function collapseAll() {
            const allUls = document.querySelectorAll('.tree ul ul');
            const allBtns = document.querySelectorAll('.tree ul .toggle-btn');
            const allLis = document.querySelectorAll('.tree li');
            
            allUls.forEach(ul => ul.style.display = 'none');
            allBtns.forEach(btn => btn.textContent = '+');
            allLis.forEach(li => {
                if (li.querySelector('ul')) {
                    li.classList.add('collapsed');
                }
            });
            
            updateStats();
        }
        
        // Toggle layout
        function toggleLayout() {
            const chart = document.getElementById('orgChart');
            if (currentLayout === 'vertical') {
                chart.classList.add('horizontal-layout');
                currentLayout = 'horizontal';
                document.getElementById('layoutToggle').textContent = 'Switch to Vertical';
            } else {
                chart.classList.remove('horizontal-layout');
                currentLayout = 'vertical';
                document.getElementById('layoutToggle').textContent = 'Switch to Horizontal';
            }
        }
        
        // Set depth level
        function setDepth(level) {
            const allLis = document.querySelectorAll('.tree li');
            
            allLis.forEach(li => {
                const depth = getNodeDepth(li);
                const ul = li.querySelector('ul');
                
                if (level === 'all') {
                    li.style.display = '';
                } else {
                    const maxDepth = parseInt(level);
                    if (depth > maxDepth) {
                        li.style.display = 'none';
                    } else {
                        li.style.display = '';
                        if (ul && depth === maxDepth) {
                            ul.style.display = 'none';
                            const btn = li.querySelector('.toggle-btn');
                            if (btn) btn.textContent = '+';
                        }
                    }
                }
            });
            
            updateStats();
        }
        
        // Get node depth
        function getNodeDepth(element) {
            let depth = 0;
            let parent = element.parentElement;
            while (parent) {
                if (parent.tagName === 'UL') {
                    depth++;
                }
                parent = parent.parentElement;
            }
            return depth;
        }
        
        // Update statistics
        function updateStats() {
            const totalNodes = document.querySelectorAll('.node').length;
            const expandedNodes = document.querySelectorAll('.tree li:not(.collapsed)').filter(li => li.querySelector('ul')).length;
            
            document.getElementById('totalPositions').textContent = totalNodes;
            document.getElementById('expandedNodes').textContent = expandedNodes;
            document.getElementById('node-count').textContent = totalNodes;
        }
        
        // Close focus mode
        function closeFocusMode() {
            document.getElementById('focus-mode').style.display = 'none';
        }
        
        // Filter by type
        function filterByType(type) {
            const allNodes = document.querySelectorAll('.node');
            allNodes.forEach(node => {
                if (node.classList.contains(type)) {
                    node.style.display = '';
                } else {
                    node.style.display = 'none';
                }
            });
        }
        
        // Initialize on load
        document.addEventListener('DOMContentLoaded', function() {
            allNodes = []; // Reset
            changeViewMode('overview');
        });
    </script>
</body>
</html>